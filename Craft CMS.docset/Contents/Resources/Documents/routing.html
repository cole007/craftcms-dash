<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
			<meta charset="utf-8" />
	<title>Routing - Documentation - Craft</title>
	<link rel="stylesheet" href="assets/css/buildwithcraft.css?20140929">
	<link rel="search" href="/opensearch.xml" title="buildwithcraft.com" type="application/opensearchdescription+xml">
	<meta name="viewport" content="width=device-width">
	<script type="text/javascript">
		document.cookie = 'hires='+(window.devicePixelRatio>1?'1':'0')+'; path=/';
	</script>
			<script type="text/javascript" src="//use.typekit.net/mhp5zog.js"></script>
		<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
		
	<script>
	// Picture element HTML5 shiv
	document.createElement('picture');
	</script>
	<script src="assets/lib/picturefill.min.js" async></script>

			<script>
			(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
			})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

			ga('create', 'UA-39036834-1', 'auto');
			ga('send', 'pageview');
					</script>
	</head>

<body class="tk-proxima-nova docs">
	
			
	<header id="site-header">
		<div class="container">
			<nav class="grid12">
				<h1><a href="/">Craft</a></h1>

				<form id="search" method="get" action="http://buildwithcraft.com/search" accept-charset="UTF-8">
					<input type="text" class="text" placeholder="Search" name="q">
					<input type="submit" class="btn">
				</form>

									<a class="download btn">Download</a>
				
				
				
									<ul>
																											<li><a href="http://buildwithcraft.com/features" class=" ">Features</a></li>
																											<li><a href="http://buildwithcraft.com/pricing" class=" ">Pricing</a></li>
																											<li><a href="http://buildwithcraft.com/docs/introduction" class="sel ">Documentation</a></li>
																											<li><a href="http://buildwithcraft.com/community" class=" ">Community</a></li>
																											<li><a href="http://buildwithcraft.com/help" class=" ">Get Help</a></li>
											</ul>
				

				<div class="menubtn">Nav</div>
				<div class="menu" id="sitenavmenu">
										<ul>
																											<li><a href="http://buildwithcraft.com/features" class=" ">Features</a></li>
																											<li><a href="http://buildwithcraft.com/pricing" class=" ">Pricing</a></li>
																											<li><a href="http://buildwithcraft.com/docs/introduction" class="sel ">Documentation</a></li>
																											<li><a href="http://buildwithcraft.com/community" class=" ">Community</a></li>
																											<li><a href="http://buildwithcraft.com/help" class=" ">Get Help</a></li>
											</ul>
				
				</div>
			</nav>
		</div>
	</header>

	<div id="main">
			<div class="container grid sidenav">
		<div class="col3">
			<nav id="sidenav">
							<h4>Documentation</h4>
			
	
					
									<h5>Getting Started</h5>
					
					<ul>
								
									<li>
								<a href="introduction.html">Introduction</a>
	
					
		
					</li>
							
									<li>
													<a href="requirements.html">Installing and Updating</a>
			
					
					<ul>
								
									<li>
								<a href="requirements.html">Requirements</a>
	
					
		
					</li>
							
									<li>
								<a href="installing.html">Installing</a>
	
					
		
					</li>
							
									<li>
								<a href="updating.html">Updating</a>
	
					
		
					</li>
						</ul>
		
					</li>
							
									<li>
								<a href="folder-structure.html">Craft’s Folder Structure</a>
	
					
		
					</li>
							
									<li>
													<a href="config-settings.html">Configuration</a>
			
					
					<ul>
								
									<li>
								<a href="config-settings.html">General Config Settings</a>
	
					
		
					</li>
							
									<li>
								<a href="multi-environment-configs.html">Multi-Environment Configs</a>
	
					
		
					</li>
							
									<li>
								<a href="php-constants.html">PHP Constants</a>
	
					
		
					</li>
						</ul>
		
					</li>
						</ul>
		
							
									<h5>Core Concepts</h5>
					
					<ul>
								
									<li>
								<a href="users.html">Users</a>
	
					
		
					</li>
							
									<li>
								<a href="sections-and-entries.html">Sections and Entries</a>
	
					
		
					</li>
							
									<li>
								<a href="globals.html">Globals</a>
	
					
		
					</li>
							
									<li>
								<a href="assets.html">Assets</a>
	
					
					<ul>
								
		
		
					</li>
						</ul>
		
					</li>
							
									<li>
								<a href="categories.html">Categories</a>
	
					
		
							
									<li>
								<a href="tags.html">Tags</a>
	
					
		
					</li>
							
									<li>
								<a href="fields.html">Fields</a>
	
					
					<ul>
								
		
		
					</li>
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
						</ul>
		
					</li>
							
									<li>
								<a href="relations.html">Relations</a>
	
					
		
							
									<li>
								<a href="routing.html" class="sel active">Routing</a>
	
					
		
					</li>
							
									<li>
								<a href="searching.html">Searching</a>
	
					
		
					</li>
						</ul>
		
							
									<h5>Templating</h5>
					
					<ul>
								
									<li>
								<a href="templating-overview.html">Templating Overview</a>
	
					
		
					</li>
							
									<li>
								<a href="twig-primer.html">Twig Primer</a>
	
					
		
					</li>
							
									<li>
								<a href="templating">Full Templating Reference<span class="external.html"></span></a>
	
					
		
					</li>
						</ul>
		
							
									<h5>Guides</h5>
					
					<ul>
								
									<li>
								<a href="localization-guide.html">Setting Up a Localized Site</a>
	
					
		
					</li>
						</ul>
		
							
									<h5>Advanced</h5>
					
					<ul>
								
									<li>
								<a href="reference-tags.html">Reference Tags</a>
	
					
		
					</li>
							
									<li>
								<a href="http://buildwithcraft.com/docs/plugins">Plugin Development<span class="external.html"></span></a>
	
					
		
					</li>
							
									<li>
								<a href="http://buildwithcraft.com/classreference">Full Class Reference<span class="external"></span></a>
	
					
		
					</li>
						</ul>
		
			
				</nav>
		</div>
		<div class="col9">
			<div id="sidenav-menubtn">
				<div class="menubtn">
											Nav
									</div>
				<div class="menu" id="sidenav-menu" data-align="center">
								<h4>Documentation</h4>
			
	
					
									<h5>Getting Started</h5>
					
					<ul>
								
									<li>
								<a href="introduction.html">Introduction</a>
	
					
		
					</li>
							
									<li>
													<a href="requirements.html">Installing and Updating</a>
			
					
					<ul>
								
									<li>
								<a href="requirements.html">Requirements</a>
	
					
		
					</li>
							
									<li>
								<a href="installing.html">Installing</a>
	
					
		
					</li>
							
									<li>
								<a href="updating.html">Updating</a>
	
					
		
					</li>
						</ul>
		
					</li>
							
									<li>
								<a href="folder-structure.html">Craft’s Folder Structure</a>
	
					
		
					</li>
							
									<li>
													<a href="config-settings.html">Configuration</a>
			
					
					<ul>
								
									<li>
								<a href="config-settings.html">General Config Settings</a>
	
					
		
					</li>
							
									<li>
								<a href="multi-environment-configs.html">Multi-Environment Configs</a>
	
					
		
					</li>
							
									<li>
								<a href="php-constants.html">PHP Constants</a>
	
					
		
					</li>
						</ul>
		
					</li>
						</ul>
		
							
									<h5>Core Concepts</h5>
					
					<ul>
								
									<li>
								<a href="users.html">Users</a>
	
					
		
					</li>
							
									<li>
								<a href="sections-and-entries.html">Sections and Entries</a>
	
					
		
					</li>
							
									<li>
								<a href="globals.html">Globals</a>
	
					
		
					</li>
							
									<li>
								<a href="assets.html">Assets</a>
	
					
					<ul>
								
		
		
					</li>
						</ul>
		
					</li>
							
									<li>
								<a href="categories.html">Categories</a>
	
					
		
							
									<li>
								<a href="tags.html">Tags</a>
	
					
		
					</li>
							
									<li>
								<a href="fields.html">Fields</a>
	
					
					<ul>
								
		
		
					</li>
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
						</ul>
		
					</li>
							
									<li>
								<a href="relations.html">Relations</a>
	
					
		
							
									<li>
								<a href="routing.html" class="sel active">Routing</a>
	
					
		
					</li>
							
									<li>
								<a href="searching.html">Searching</a>
	
					
		
					</li>
						</ul>
		
							
									<h5>Templating</h5>
					
					<ul>
								
									<li>
								<a href="templating-overview.html">Templating Overview</a>
	
					
		
					</li>
							
									<li>
								<a href="twig-primer.html">Twig Primer</a>
	
					
		
					</li>
							
									<li>
								<a href="templating">Full Templating Reference<span class="external.html"></span></a>
	
					
		
					</li>
						</ul>
		
							
									<h5>Guides</h5>
					
					<ul>
								
									<li>
								<a href="localization-guide.html">Setting Up a Localized Site</a>
	
					
		
					</li>
						</ul>
		
							
									<h5>Advanced</h5>
					
					<ul>
								
									<li>
								<a href="reference-tags.html">Reference Tags</a>
	
					
		
					</li>
							
									<li>
								<a href="http://buildwithcraft.com/docs/plugins">Plugin Development<span class="external.html"></span></a>
	
					
		
					</li>
							
									<li>
								<a href="http://buildwithcraft.com/classreference">Full Class Reference<span class="external"></span></a>
	
					
		
					</li>
						</ul>
		
			
	
				</div>
			</div>

			<div id="content">
										<header class="main-header">
				<h1>Routing</h1>
				

			</header>
		
																																														
																																																																											
																																																			
																																																			
																																																			
																								
					<p>When a request comes in, Craft goes through several checks when determining where to route the&nbsp;request.</p>
<p>Here is an outline of what that&nbsp;entails:</p>
<ol>
<li>
<p><strong>Should Craft handle this request in the first&nbsp;place?</strong></p>
<p>It’s important to keep in mind that Craft doesn’t actually get involved for <em>every</em> request that touches your server – only requests that go to your index.php&nbsp;file.</p>
<p>The .htaccess file that <a href="http://buildwithcraft.com/help/remove-index.php">comes with Craft</a> will redirect all would-be 404 requests over to index.php behind the scenes, which is why Craft is able to respond to URLs that don’t point to any actual folder/file in your web root. But if you point your browser directly at a file that <em>does</em> exist (such as a front-end image URL), Apache is going to serve that file directly. Craft won’t be summoned for&nbsp;that.</p>
</li>
<li>
<p><strong>Is it a resource&nbsp;request?</strong></p>
<p>Resource request URIs begin with “cpresources/” (or whatever your <a href="config-settings#resourceTrigger.html">resourceTrigger</a> config setting is set to). They are used to serve CP resources, user photos,&nbsp;etc..</p>
</li>
<li>
<p><strong>Is it an action&nbsp;request?</strong></p>
<p>Action requests either have a URL which begins with “actions/” (or whatever your <a href="config-settings#actionTrigger.html">actionTrigger</a> config setting is set to), or an “action” param in POST or the query string. Action requests get routed to a controller action, which are used to perform… <em>actions</em>. Controller actions are built into the system for core actions, but plugins may also have Controllers that define their own custom&nbsp;actions.</p>
<p>The request doesn’t necessarily end after a controller has been called. The controller may allow it to keep&nbsp;going.</p>
</li>
<li>
<p><strong>Is it an entry/category&nbsp;request?</strong></p>
<p>If the URI matches an <a href="sections-and-entries">entry’s</a> or <a href="http://buildwithcraft.com/docs/categories.html">category’s</a> URI, the section’s/category group’s template will get loaded, and the matched element will be made available to the template via a pre-populated <code>entry</code> or <code>category</code>&nbsp;variable.</p>
<p>(This step is not actually limited to entries and categories – plugins are also capable of adding their own types of elements, which can opt to have their own dedicated&nbsp;URLs.)</p>
</li>
<li>
<p><strong>Does the URI match any Dynamic&nbsp;Routes?</strong></p>
<p>If the URI matches any <a href="#dynamic-routes">dynamic routes</a>, the template specified by that route will get loaded. If the route contains any tokens, they will be available as variables to that&nbsp;template.</p>
</li>
<li>
<p><strong>Does the URI match a&nbsp;template?</strong></p>
<p>Finally, Craft will see if the URI is a valid <a href="templating-overview#template-paths.html">template path</a>. If it is, it will return the matched template. Note that if any of the URI segments begin with an underscore (‘_’), Craft will return a 404, since template path segments that begin with an underscore are considered “hidden” from direct&nbsp;access.</p>
</li>
<li>
<p><strong>404</strong></p>
<p>If none of those checks are successful, Craft will return a 404. You can customize your site’s 404 page by placing a “404.html” template at the root of your craft/templates/&nbsp;folder.</p>
</li>
</ol>
<h2 id=dynamic-routes>Dynamic Routes&nbsp;<a class="anchor" href="#dynamic-routes" title="Direct link to Dynamic Routes">#</a></h2>
<p>There are times when you want a URL to load a template, but you don’t want the URI to match the template&nbsp;path.</p>
<p>A good example of this is dynamic URLs, such as a yearly archive template, where you want the year to be one of the segments in the URL (e.g. “blog/archive/2012”). It would be silly to create a new template for every year. Instead, your best bet is going to be to set up a new&nbsp;Route.</p>
<p>To create a new Route, go to Settings → Routes and click the “New Route” button. A modal window will appear where you can define the route&nbsp;settings:</p>
<div class="image"><picture><!--[if IE 9]><video style="display: none;"><![endif]--><source media="(min-width: 960px)" srcset="http://buildwithcraft.com/assets/images/docs/_528xAUTO_crop_center-center/routes.2x.jpg, http://buildwithcraft.com/assets/images/docs/routes.2x.jpg 2x"><source media="(min-width: 768px)" srcset="http://buildwithcraft.com/assets/images/docs/_528xAUTO_crop_center-center/routes.2x.jpg, http://buildwithcraft.com/assets/images/docs/routes.2x.jpg 2x"><source media="(min-width: 321px)" srcset="http://buildwithcraft.com/assets/images/docs/_528xAUTO_crop_center-center/routes.2x.jpg, http://buildwithcraft.com/assets/images/docs/routes.2x.jpg 2x"><source media="(max-width: 320px)" srcset="http://buildwithcraft.com/assets/images/docs/_290xAUTO_crop_center-center/routes.2x.jpg, http://buildwithcraft.com/assets/images/docs/_580xAUTO_crop_center-center/routes.2x.jpg 2x"><!--[if IE 9]></video><![endif]--><img srcset="http://buildwithcraft.com/assets/images/docs/_528xAUTO_crop_center-center/routes.2x.jpg, http://buildwithcraft.com/assets/images/docs/routes.2x.jpg 2x" width="528" height="416" alt="routes.2x"></picture></div>
<p>The modal has the following&nbsp;settings:</p>
<ul>
<li>What should the URI look&nbsp;like?</li>
<li>Which template should get&nbsp;loaded?</li>
</ul>
<p>The first setting can contain “tokens”, which represent a range of possible matches, rather than a specific string. (The “year” token, for example, represents four consecutive digits.) When you click on a token, it will get inserted into the URI setting wherever the cursor&nbsp;is.</p>
<p>So if you want to match URIs that look like “blog/archive/2013”, you would type “blog/archive/” into the URI field, and then click on the “year”&nbsp;token.</p>
<div class="pane warning"><p>Your URI should <strong>not</strong> begin with a&nbsp;slash&nbsp;(/).</p></div>
<p>After defining your URI pattern and entering a template path, click the ‘Save’ button. The modal will close, revealing your new route on the page. Now when you point your browser to <a href="http://example.com/blog/archive/2013">http://example.com/blog/archive/2013</a>, it will match your new route, and the specified template will get loaded. The value of the ‘year’ token will also be available to the template as a variable called&nbsp;“year”.</p>
<h3 id=available-tokens>Available Tokens&nbsp;<a class="anchor" href="#available-tokens" title="Direct link to Available Tokens">#</a></h3>
<p>The following tokens are available to the URI&nbsp;setting:</p>
<ul>
<li><strong>*</strong> – Any string of characters, except for a forward slash&nbsp;(/)</li>
<li><strong>day</strong> – Day of a month (1-31 or&nbsp;01-31)</li>
<li><strong>month</strong> – Numeric representation of a month (1-12 or&nbsp;01-12)</li>
<li><strong>number</strong> – Any positive&nbsp;integer</li>
<li><strong>page</strong> – Any positive&nbsp;integer</li>
<li><strong>slug</strong> – Any string of characters, except for a forward slash&nbsp;(/)</li>
<li><strong>tag</strong> – Any string of characters, except for a forward slash&nbsp;(/)</li>
<li><strong>year</strong> – Four consecutive&nbsp;digits</li>
</ul>
<h2 id=advanced-routing>Advanced Routing&nbsp;<a class="anchor" href="#advanced-routing" title="Direct link to Advanced Routing">#</a></h2>
<p>If you need to match a URL pattern that’s not covered by the available route tokens and you’re comfortable with regular expressions, you can set up your routes in craft/config/routes.php as well. When a request comes in, Craft checks this file first, and then the routes defined in Settings →&nbsp;Routes.</p>
<h3 id=basic-syntax>Basic Syntax&nbsp;<a class="anchor" href="#basic-syntax" title="Direct link to Basic Syntax">#</a></h3>
<p>Routes in craft/config/routes.php generally follow this&nbsp;syntax:</p>
<pre><code class="language-php">'some/uri/pattern' =&gt; 'template/path',</code></pre>
<p>Note that you don’t need to escape forward slashes; Craft will automatically escape them for&nbsp;you.</p>
<h3 id=accessing-subpatterns-in-your-templates>Accessing Subpatterns in your Templates&nbsp;<a class="anchor" href="#accessing-subpatterns-in-your-templates" title="Direct link to Accessing Subpatterns in your Templates">#</a></h3>
<p>If your route contains any subpatterns, a ‘matches’ array will be passed to the matched template containing them. For example, with this&nbsp;route:</p>
<pre><code class="language-php">'news/(\d{4})/(\d{2})' =&gt; 'news/_archive',</code></pre>
<p>…if you access <a href="http://example.com/news/2014/04">http://example.com/news/2014/04</a>, your news/_archive.html template will get loaded with a ‘matches’ variable set to&nbsp;this:</p>
<pre><code class="language-php">array(
    0 =&gt; 'news/2014/04',
    1 =&gt; '2014',
    2 =&gt; '04'
)</code></pre>
<p>If you specify any named subpatterns, then those matches will also get their own normal variables. For example, with this&nbsp;route:</p>
<pre><code class="language-php">'news/(?P&lt;year&gt;\d{4})/(?P&lt;month&gt;\d{2})' =&gt; 'news/_archive',</code></pre>
<p>…if you access <a href="http://example.com/news/2014/04">http://example.com/news/2014/04</a>, your news/_archive.html template will get loaded with ‘year’ and ‘month’ variables set to “2014” and&nbsp;“04”.</p>
<h3 id=routing-to-controller-actions>Routing to Controller Actions&nbsp;<a class="anchor" href="#routing-to-controller-actions" title="Direct link to Routing to Controller Actions">#</a></h3>
<p>You can also set your route to point to a controller action, rather than a&nbsp;template:</p>
<pre><code class="language-php">'some/uri/pattern' =&gt; array('action' =&gt; 'action/path'),</code></pre>
									
					<footer>
				<nav class="rellinks">
															
											<div class="prev">			<a href="relations.html">Relations</a>
	</div>
					
											<div class="next">			<a href="searching.html">Searching</a>
	</div>
									</nav>
			</footer>
						</div>
		</div>
	</div>
	</div>

	
	<footer class="site-footer">
		<div class="container grid">
			<div id="footer-links" class="col6 grid">
				<div class="col2">
					<h4>About Craft</h4>
					<ul>
						<li><a href="http://buildwithcraft.com/features">Features</a></li>
						<li><a href="http://buildwithcraft.com/pricing">Pricing</a></li>
						<li><a href="http://buildwithcraft.com/showcase">Showcase</a></li>
						<li><a href="http://buildwithcraft.com/updates">Updates</a></li>
						<li><a href="http://buildwithcraft.com/resources">Brand Resources</a></li>
						<li><a href="http://buildwithcraft.com/license">License Agreement</a></li>
					</ul>
				</div>

				<div class="col2">
					<h4>Learning Craft</h4>
					<ul>
						<li><a href="http://buildwithcraft.com/docs">Documentation</a></li>
						<li><a href="http://craftcms.stackexchange.com/">Craft Q&amp;A on Stack Exchange</a></li>
												<li><a href="http://github.com/pixelandtonic/ontherocks" target="_blank">On The Rocks demo site</a></li>
						<li><a href="http://mijingo.com/products/screencasts/craft-cms-tutorial/" target="_blank">Video series by Mijingo</a></li>
						<li><a href="http://twig.sensiolabs.org/doc/templates.html" target="_blank">Twig Documentation</a></li>
					</ul>
				</div>

				<div class="col2">
					<h4>Community</h4>
					<ul>
						<li><a href="http://twitter.com/craftcms" target="_blank">Twitter</a></li>
						<li><a href="http://plus.google.com/communities/106505340287442511226" target="_blank">Google+</a></li>
						<li><a href="http://chat.buildwithcraft.com" target="_blank">Craft Chat</a></li>
						<li><a href="http://craftcookbook.net/" target="_blank">Craft Cookbook</a></li>
						<li><a href="http://straightupcraft.com/" target="_blank">Straight Up Craft</a></li>
					</ul>
				</div>
			</div>
			<div id="footer-subscribe" class="col6">
				<h4>Subscribe to the Newsletter</h4>
				<form id="subscribe" method="post" action="">
					<input type="hidden" name="action" value="campaignMonitor/subscribe">
					<input type="hidden" name="listId" value="583b11822c17b5a2a0b4f5363c978cf9">
					<input class="text" type="text" name="email" placeholder="Your email address" value="">
					<input class="btn tk-proxima-nova" type="submit" value="Submit">
					<div class="spinner" style="display: none;" title="Loading…"></div>
					<div class="success" style="display: none;" title="Success!"></div>
				</form>
			</div>
		</div>
	</footer>

	<footer class="site-footer">
		<div class="container">
			<div id="footer-logos">
				<a id="pt" href="http://pixelandtonic.com" target="_blank" title="Craft is a Pixel &amp; Tonic concoction."></a>
				<a id="arcustech" href="http://arcustech.com" target="_blank" title="This site is hosted by our friends at ArcusTech."></a>
			</div>

			<p id="copyright">© 2014 Pixel & Tonic, Inc. All rights reserved.</p>
		</div>
	</footer>
		

	<script type="text/javascript" src="assets/lib/jquery-1.10.1.min.js"></script>
	<script type="text/javascript">
		window.craftDownloadUrl = "http\x3A\x2F\x2Fdownload.buildwithcraft.com\x2Fcraft\x2F2.2\x2F2.2.2601\x2FCraft\x2D2.2.2601.zip";
	</script>
	<script type="text/javascript" src="assets/lib/garnish-0.1.min.js"></script>
	<script type="text/javascript" src="assets/js/buildwithcraft.js?20140929"></script>
	<script type="text/javascript" src="assets/lib/prism.js"></script>

	
			
					<script type='text/javascript'>
				(function (d, t) {
					var bh = d.createElement(t), s = d.getElementsByTagName(t)[0];
					bh.type = 'text/javascript';
					bh.src = '//www.bugherd.com/sidebarv2.js?apikey=7gpoe4fiut0zajowrhx15w';
					s.parentNode.insertBefore(bh, s);
				})(document, 'script');
			</script>
			</body>
</html>
