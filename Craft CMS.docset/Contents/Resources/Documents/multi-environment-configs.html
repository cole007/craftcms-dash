<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
			<meta charset="utf-8" />
	<title>Multi-Environment Configs - Documentation - Craft</title>
	<link rel="stylesheet" href="assets/css/buildwithcraft.css?20140929">
	<link rel="search" href="/opensearch.xml" title="buildwithcraft.com" type="application/opensearchdescription+xml">
	<meta name="viewport" content="width=device-width">
	<script type="text/javascript">
		document.cookie = 'hires='+(window.devicePixelRatio>1?'1':'0')+'; path=/';
	</script>
			<script type="text/javascript" src="//use.typekit.net/mhp5zog.js"></script>
		<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
		
	<script>
	// Picture element HTML5 shiv
	document.createElement('picture');
	</script>
	<script src="assets/lib/picturefill.min.js" async></script>

			<script>
			(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
			})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

			ga('create', 'UA-39036834-1', 'auto');
			ga('send', 'pageview');
					</script>
	</head>

<body class="tk-proxima-nova docs">
	
			
	<header id="site-header">
		<div class="container">
			<nav class="grid12">
				<h1><a href="/">Craft</a></h1>

				<form id="search" method="get" action="http://buildwithcraft.com/search" accept-charset="UTF-8">
					<input type="text" class="text" placeholder="Search" name="q">
					<input type="submit" class="btn">
				</form>

									<a class="download btn">Download</a>
				
				
				
									<ul>
																											<li><a href="http://buildwithcraft.com/features" class=" ">Features</a></li>
																											<li><a href="http://buildwithcraft.com/pricing" class=" ">Pricing</a></li>
																											<li><a href="http://buildwithcraft.com/docs/introduction" class="sel ">Documentation</a></li>
																											<li><a href="http://buildwithcraft.com/community" class=" ">Community</a></li>
																											<li><a href="http://buildwithcraft.com/help" class=" ">Get Help</a></li>
											</ul>
				

				<div class="menubtn">Nav</div>
				<div class="menu" id="sitenavmenu">
										<ul>
																											<li><a href="http://buildwithcraft.com/features" class=" ">Features</a></li>
																											<li><a href="http://buildwithcraft.com/pricing" class=" ">Pricing</a></li>
																											<li><a href="http://buildwithcraft.com/docs/introduction" class="sel ">Documentation</a></li>
																											<li><a href="http://buildwithcraft.com/community" class=" ">Community</a></li>
																											<li><a href="http://buildwithcraft.com/help" class=" ">Get Help</a></li>
											</ul>
				
				</div>
			</nav>
		</div>
	</header>

	<div id="main">
			<div class="container grid sidenav">
		<div class="col3">
			<nav id="sidenav">
							<h4>Documentation</h4>
			
	
					
									<h5>Getting Started</h5>
					
					<ul>
								
									<li>
								<a href="introduction.html">Introduction</a>
	
					
		
					</li>
							
									<li>
													<a href="requirements.html">Installing and Updating</a>
			
					
					<ul>
								
									<li>
								<a href="requirements.html">Requirements</a>
	
					
		
					</li>
							
									<li>
								<a href="installing.html">Installing</a>
	
					
		
					</li>
							
									<li>
								<a href="updating.html">Updating</a>
	
					
		
					</li>
						</ul>
		
					</li>
							
									<li>
								<a href="folder-structure.html">Craft’s Folder Structure</a>
	
					
		
					</li>
							
									<li>
													<a href="config-settings.html">Configuration</a>
			
					
					<ul>
								
									<li>
								<a href="config-settings.html">General Config Settings</a>
	
					
		
					</li>
							
									<li>
								<a href="multi-environment-configs.html" class="sel active">Multi-Environment Configs</a>
	
					
		
					</li>
							
									<li>
								<a href="php-constants.html">PHP Constants</a>
	
					
		
					</li>
						</ul>
		
					</li>
						</ul>
		
							
									<h5>Core Concepts</h5>
					
					<ul>
								
									<li>
								<a href="users.html">Users</a>
	
					
		
					</li>
							
									<li>
								<a href="sections-and-entries.html">Sections and Entries</a>
	
					
		
					</li>
							
									<li>
								<a href="globals.html">Globals</a>
	
					
		
					</li>
							
									<li>
								<a href="assets.html">Assets</a>
	
					
					<ul>
								
		
		
					</li>
						</ul>
		
					</li>
							
									<li>
								<a href="categories.html">Categories</a>
	
					
		
							
									<li>
								<a href="tags.html">Tags</a>
	
					
		
					</li>
							
									<li>
								<a href="fields.html">Fields</a>
	
					
					<ul>
								
		
		
					</li>
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
						</ul>
		
					</li>
							
									<li>
								<a href="relations.html">Relations</a>
	
					
		
							
									<li>
								<a href="routing.html">Routing</a>
	
					
		
					</li>
							
									<li>
								<a href="searching.html">Searching</a>
	
					
		
					</li>
						</ul>
		
							
									<h5>Templating</h5>
					
					<ul>
								
									<li>
								<a href="templating-overview.html">Templating Overview</a>
	
					
		
					</li>
							
									<li>
								<a href="twig-primer.html">Twig Primer</a>
	
					
		
					</li>
							
									<li>
								<a href="templating">Full Templating Reference<span class="external.html"></span></a>
	
					
		
					</li>
						</ul>
		
							
									<h5>Guides</h5>
					
					<ul>
								
									<li>
								<a href="localization-guide.html">Setting Up a Localized Site</a>
	
					
		
					</li>
						</ul>
		
							
									<h5>Advanced</h5>
					
					<ul>
								
									<li>
								<a href="reference-tags.html">Reference Tags</a>
	
					
		
					</li>
							
									<li>
								<a href="http://buildwithcraft.com/docs/plugins">Plugin Development<span class="external.html"></span></a>
	
					
		
					</li>
							
									<li>
								<a href="http://buildwithcraft.com/classreference">Full Class Reference<span class="external"></span></a>
	
					
		
					</li>
						</ul>
		
			
				</nav>
		</div>
		<div class="col9">
			<div id="sidenav-menubtn">
				<div class="menubtn">
											Nav
									</div>
				<div class="menu" id="sidenav-menu" data-align="center">
								<h4>Documentation</h4>
			
	
					
									<h5>Getting Started</h5>
					
					<ul>
								
									<li>
								<a href="introduction.html">Introduction</a>
	
					
		
					</li>
							
									<li>
													<a href="requirements.html">Installing and Updating</a>
			
					
					<ul>
								
									<li>
								<a href="requirements.html">Requirements</a>
	
					
		
					</li>
							
									<li>
								<a href="installing.html">Installing</a>
	
					
		
					</li>
							
									<li>
								<a href="updating.html">Updating</a>
	
					
		
					</li>
						</ul>
		
					</li>
							
									<li>
								<a href="folder-structure.html">Craft’s Folder Structure</a>
	
					
		
					</li>
							
									<li>
													<a href="config-settings.html">Configuration</a>
			
					
					<ul>
								
									<li>
								<a href="config-settings.html">General Config Settings</a>
	
					
		
					</li>
							
									<li>
								<a href="multi-environment-configs.html" class="sel active">Multi-Environment Configs</a>
	
					
		
					</li>
							
									<li>
								<a href="php-constants.html">PHP Constants</a>
	
					
		
					</li>
						</ul>
		
					</li>
						</ul>
		
							
									<h5>Core Concepts</h5>
					
					<ul>
								
									<li>
								<a href="users.html">Users</a>
	
					
		
					</li>
							
									<li>
								<a href="sections-and-entries.html">Sections and Entries</a>
	
					
		
					</li>
							
									<li>
								<a href="globals.html">Globals</a>
	
					
		
					</li>
							
									<li>
								<a href="assets.html">Assets</a>
	
					
					<ul>
								
		
		
					</li>
						</ul>
		
					</li>
							
									<li>
								<a href="categories.html">Categories</a>
	
					
		
							
									<li>
								<a href="tags.html">Tags</a>
	
					
		
					</li>
							
									<li>
								<a href="fields.html">Fields</a>
	
					
					<ul>
								
		
		
					</li>
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
							
		
		
						</ul>
		
					</li>
							
									<li>
								<a href="relations.html">Relations</a>
	
					
		
							
									<li>
								<a href="routing.html">Routing</a>
	
					
		
					</li>
							
									<li>
								<a href="searching.html">Searching</a>
	
					
		
					</li>
						</ul>
		
							
									<h5>Templating</h5>
					
					<ul>
								
									<li>
								<a href="templating-overview.html">Templating Overview</a>
	
					
		
					</li>
							
									<li>
								<a href="twig-primer.html">Twig Primer</a>
	
					
		
					</li>
							
									<li>
								<a href="templating">Full Templating Reference<span class="external.html"></span></a>
	
					
		
					</li>
						</ul>
		
							
									<h5>Guides</h5>
					
					<ul>
								
									<li>
								<a href="localization-guide.html">Setting Up a Localized Site</a>
	
					
		
					</li>
						</ul>
		
							
									<h5>Advanced</h5>
					
					<ul>
								
									<li>
								<a href="reference-tags.html">Reference Tags</a>
	
					
		
					</li>
							
									<li>
								<a href="http://buildwithcraft.com/docs/plugins">Plugin Development<span class="external.html"></span></a>
	
					
		
					</li>
							
									<li>
								<a href="http://buildwithcraft.com/classreference">Full Class Reference<span class="external"></span></a>
	
					
		
					</li>
						</ul>
		
			
	
				</div>
			</div>

			<div id="content">
										<header class="main-header">
				<h1>Multi-Environment Configs</h1>
				

			</header>
		
																																														
																																																			
																																																			
																																																			
																																																			
																																																																											
																																																			
																																																			
																								
					<p>If you want to share the same Craft config files across two or more environments (e.g. Dev, Staging, and Production), you’re in luck! Craft makes it extremely easy to do&nbsp;so.</p>
<p>Normally, your craft/config/db.php and craft/config/general.php files would return a one-dimentional array of whatever <a href="config-settings.html">configuration settings</a> you want to override for the given&nbsp;site:</p>
<pre><code class="language-php">return array(
    'omitScriptNameInUrls' =&gt; true,
);</code></pre>
<p>Without any help on Craft’s part, you could technically add multi-environment support to that yourself, by either returning different arrays depending on the current server, or using ternary operators within the&nbsp;array:</p>
<pre><code class="language-php">return array(
    'omitScriptNameInUrls' =&gt; true,
    'devMode' =&gt; ($_SERVER['SERVER_NAME'] == 'example.dev' ? true : false),
);</code></pre>
<p>That can get a little cumbersome though. Thankfully, Craft supports the ability for you to return nested, environment-specific&nbsp;arrays.</p>
<p>First, place all of your common config settings into a nested array with the key&nbsp;<code>'*'</code>:</p>
<pre><code class="language-php">return array(
    '*' =&gt; array(
        'omitScriptNameInUrls' =&gt; true,
    )
);</code></pre>
<p>Whatever is listed in the <code>'*'</code> array will be applied to all&nbsp;environments.</p>
<div class="pane warning"><p>The <code>'*'</code> array is required to enable Craft’s multi-environment config support, even if you don’t need it. Craft specifically checks for it when deciding whether to enable multi-environment config support&nbsp;or&nbsp;not.</p></div>
<p>Next up, add a new nested array for each environment-specific config you&nbsp;need:</p>
<pre><code class="language-php">return array(
    '*' =&gt; array(
        'omitScriptNameInUrls' =&gt; true,
    ),

    'example.dev' =&gt; array(
        'devMode' =&gt; true,
    ),

    'example.com' =&gt; array(
        'cooldownDuration' =&gt; 0,
    )
);</code></pre>
<p>Craft will compare the additional array keys (<code>'example.dev'</code> and <code>'example.com'</code>) with the <code>$_SERVER['SERVER_NAME']</code> server environment variable. If your server is configured properly, that should be your site’s domain name (without the&nbsp;‘http://’).</p>
<div class="pane tip"><p>You can change the string Craft uses to determine the current environment by defining the <a href="php-constants#craft-environment.html"><code>CRAFT_ENVIRONMENT</code></a> constant in your&nbsp;index.php&nbsp;file.</p></div>
<p>When Craft is comparing your config keys with <code>$_SERVER['SERVER_NAME']</code>, it’s only looking for a <em>partial match</em>. So the environment key <code>'example.com'</code> will also work if you’re accessing your site via www.example.com or any other subdomain. You could even just use the TLD if you’re feeling&nbsp;adventurous:</p>
<pre><code class="language-php">return array(
    '*' =&gt; array(
        'omitScriptNameInUrls' =&gt; true,
    ),

    '.dev' =&gt; array(
        'devMode' =&gt; true,
    ),

    '.com' =&gt; array(
        'cooldownDuration' =&gt; 0,
    )
);</code></pre>
<h3 id=adding-multi-environment-configs-to-db-php>Adding Multi-Environment Configs to db.php&nbsp;<a class="anchor" href="#adding-multi-environment-configs-to-db-php" title="Direct link to Adding Multi-Environment Configs to db.php">#</a></h3>
<p>All of the examples above are for craft/config/general.php, but all of the principles hold true for craft/config/db.php as&nbsp;well:</p>
<pre><code class="language-php">return array(
    '*' =&gt; array(
        'tablePrefix' =&gt; 'craft',
    ),
    '.dev' =&gt; array(
        'server' =&gt; 'localhost',
        'user' =&gt; 'root',
        'password' =&gt; 'letmein',
        'database' =&gt; 'buildwithcraft',
    ),
    '.com' =&gt; array(
        'server' =&gt; 'localhost',
        'user' =&gt; 'av12345',
        'password' =&gt; '$uP3r$3jp3t',
        'database' =&gt; 'av12345-buildwithcraft',
    ),
);</code></pre>
<p>Just as with general.php, that <code>'*'</code> key is required to trigger multi-environment config support, even if you end up not needing&nbsp;it.</p>
<hr />
<h2 id=environment-specific-variables>Environment-Specific Variables&nbsp;<a class="anchor" href="#environment-specific-variables" title="Direct link to Environment-Specific Variables">#</a></h2>
<p>Something else that goes hand-in-hand with Craft’s multi-environment config support is the <a href="config-settings#environmentVariables.html">environmentVariables</a> config setting. The value of this setting is an array of custom variables that can be accessed from various settings within the Control&nbsp;Panel.</p>
<h3 id=example-multi-environment-asset-source-settings>Example: Multi-Environment Asset Source Settings&nbsp;<a class="anchor" href="#example-multi-environment-asset-source-settings" title="Direct link to Example: Multi-Environment Asset Source Settings">#</a></h3>
<p>A popular use case for the environmentVariables config setting is the File System Path and URL settings on asset sources. While these settings <em>can</em> be relative, often times people prefer them to be absolute. In a multi-environment setup, the only way to do that is with&nbsp;environmentVariables.</p>
<p>First we need to identify the areas of these settings that will differ depending on the environment. Let’s say we only have a single Assets Source, and its settings are as&nbsp;follows:</p>
<ul>
<li><strong>File System Path (Local):</strong>&nbsp;/users/brandon/Sites/example.dev/public/assets/images/</li>
<li><strong>File System Path (Prod.):</strong>&nbsp;/storage/av12345/www/public_html/assets/images/</li>
<li><strong>URL (Local):</strong>&nbsp;<a href="http://example.dev/assets/images/">http://example.dev/assets/images/</a></li>
<li><strong>URL (Prod.):</strong>&nbsp;<a href="http://example.com/assets/images/">http://example.com/assets/images/</a></li>
</ul>
<p>In each case, everything before “assets/images/” could be different between the environments. To address this, we should create two custom environment variables. Their names are completely up to us – we’ll go with “<code>basePath</code>” and “<code>baseUrl</code>”.</p>
<pre><code class="language-php">return array(
    '*' =&gt; array(
        // ...
    ),

    'example.dev' =&gt; array(
        // ...

        'environmentVariables' =&gt; array(
            'basePath' =&gt; '/users/brandon/Sites/example.dev/public/',
            'baseUrl'  =&gt; 'http://example.dev/',
        )
    ),

    'example.com' =&gt; array(
        // ...

        'environmentVariables' =&gt; array(
            'basePath' =&gt; '/storage/av12345/www/public_html/',
            'baseUrl'  =&gt; 'http://example.com/',
        )
    )
);</code></pre>
<p>With those environment variables in place, we can now go into our asset source settings and type in some tags with corresponding&nbsp;names:</p>
<div class="image"><picture><!--[if IE 9]><video style="display: none;"><![endif]--><source media="(min-width: 960px)" srcset="http://buildwithcraft.com/assets/images/docs/_527xAUTO_crop_center-center/environment-variables.2x.png, http://buildwithcraft.com/assets/images/docs/environment-variables.2x.png 2x"><source media="(min-width: 768px)" srcset="http://buildwithcraft.com/assets/images/docs/_527xAUTO_crop_center-center/environment-variables.2x.png, http://buildwithcraft.com/assets/images/docs/environment-variables.2x.png 2x"><source media="(min-width: 321px)" srcset="http://buildwithcraft.com/assets/images/docs/_527xAUTO_crop_center-center/environment-variables.2x.png, http://buildwithcraft.com/assets/images/docs/environment-variables.2x.png 2x"><source media="(max-width: 320px)" srcset="http://buildwithcraft.com/assets/images/docs/_290xAUTO_crop_center-center/environment-variables.2x.png, http://buildwithcraft.com/assets/images/docs/_580xAUTO_crop_center-center/environment-variables.2x.png 2x"><!--[if IE 9]></video><![endif]--><img srcset="http://buildwithcraft.com/assets/images/docs/_527xAUTO_crop_center-center/environment-variables.2x.png, http://buildwithcraft.com/assets/images/docs/environment-variables.2x.png 2x" width="527" height="413" alt="environment-variables.2x"></picture></div>
<p>That’s it! And the next time you need to create an asset source, you’ll be able to re-use the same <code>{basePath}</code> and <code>{baseUrl}</code> tags again – no need to manage several different asset sources’ settings individually from your&nbsp;config.</p>
<h3 id=setting-support>Setting Support&nbsp;<a class="anchor" href="#setting-support" title="Direct link to Setting Support">#</a></h3>
<p>There are only three settings within Craft that support environment variables. They&nbsp;are:</p>
<ul>
<li>File System Path (in asset source&nbsp;settings)</li>
<li>URL (in asset source&nbsp;settings)</li>
<li>Site URL (in Settings →&nbsp;General)</li>
</ul>
<div class="pane tip"><p>It’s generally better to use the <a href="config-settings#siteUrl">siteUrl</a> config setting for setting your site URL, rather than placing an environment variable within the Site URL setting in Settings → General. (See <a href="http://craftcms.stackexchange.com/a/921/9.html">this answer</a> on Craft’s Stack Exchange site for&nbsp;an&nbsp;explanation.)</p></div>
									
					<footer>
				<nav class="rellinks">
															
											<div class="prev">			<a href="config-settings.html">General Config Settings</a>
	</div>
					
											<div class="next">			<a href="php-constants.html">PHP Constants</a>
	</div>
									</nav>
			</footer>
						</div>
		</div>
	</div>
	</div>

	
	<footer class="site-footer">
		<div class="container grid">
			<div id="footer-links" class="col6 grid">
				<div class="col2">
					<h4>About Craft</h4>
					<ul>
						<li><a href="http://buildwithcraft.com/features">Features</a></li>
						<li><a href="http://buildwithcraft.com/pricing">Pricing</a></li>
						<li><a href="http://buildwithcraft.com/showcase">Showcase</a></li>
						<li><a href="http://buildwithcraft.com/updates">Updates</a></li>
						<li><a href="http://buildwithcraft.com/resources">Brand Resources</a></li>
						<li><a href="http://buildwithcraft.com/license">License Agreement</a></li>
					</ul>
				</div>

				<div class="col2">
					<h4>Learning Craft</h4>
					<ul>
						<li><a href="http://buildwithcraft.com/docs">Documentation</a></li>
						<li><a href="http://craftcms.stackexchange.com/">Craft Q&amp;A on Stack Exchange</a></li>
												<li><a href="http://github.com/pixelandtonic/ontherocks" target="_blank">On The Rocks demo site</a></li>
						<li><a href="http://mijingo.com/products/screencasts/craft-cms-tutorial/" target="_blank">Video series by Mijingo</a></li>
						<li><a href="http://twig.sensiolabs.org/doc/templates.html" target="_blank">Twig Documentation</a></li>
					</ul>
				</div>

				<div class="col2">
					<h4>Community</h4>
					<ul>
						<li><a href="http://twitter.com/craftcms" target="_blank">Twitter</a></li>
						<li><a href="http://plus.google.com/communities/106505340287442511226" target="_blank">Google+</a></li>
						<li><a href="http://chat.buildwithcraft.com" target="_blank">Craft Chat</a></li>
						<li><a href="http://craftcookbook.net/" target="_blank">Craft Cookbook</a></li>
						<li><a href="http://straightupcraft.com/" target="_blank">Straight Up Craft</a></li>
					</ul>
				</div>
			</div>
			<div id="footer-subscribe" class="col6">
				<h4>Subscribe to the Newsletter</h4>
				<form id="subscribe" method="post" action="">
					<input type="hidden" name="action" value="campaignMonitor/subscribe">
					<input type="hidden" name="listId" value="583b11822c17b5a2a0b4f5363c978cf9">
					<input class="text" type="text" name="email" placeholder="Your email address" value="">
					<input class="btn tk-proxima-nova" type="submit" value="Submit">
					<div class="spinner" style="display: none;" title="Loading…"></div>
					<div class="success" style="display: none;" title="Success!"></div>
				</form>
			</div>
		</div>
	</footer>

	<footer class="site-footer">
		<div class="container">
			<div id="footer-logos">
				<a id="pt" href="http://pixelandtonic.com" target="_blank" title="Craft is a Pixel &amp; Tonic concoction."></a>
				<a id="arcustech" href="http://arcustech.com" target="_blank" title="This site is hosted by our friends at ArcusTech."></a>
			</div>

			<p id="copyright">© 2014 Pixel & Tonic, Inc. All rights reserved.</p>
		</div>
	</footer>
		

	<script type="text/javascript" src="assets/lib/jquery-1.10.1.min.js"></script>
	<script type="text/javascript">
		window.craftDownloadUrl = "http\x3A\x2F\x2Fdownload.buildwithcraft.com\x2Fcraft\x2F2.2\x2F2.2.2601\x2FCraft\x2D2.2.2601.zip";
	</script>
	<script type="text/javascript" src="assets/lib/garnish-0.1.min.js"></script>
	<script type="text/javascript" src="assets/js/buildwithcraft.js?20140929"></script>
	<script type="text/javascript" src="assets/lib/prism.js"></script>

	
			
					<script type='text/javascript'>
				(function (d, t) {
					var bh = d.createElement(t), s = d.getElementsByTagName(t)[0];
					bh.type = 'text/javascript';
					bh.src = '//www.bugherd.com/sidebarv2.js?apikey=7gpoe4fiut0zajowrhx15w';
					s.parentNode.insertBefore(bh, s);
				})(document, 'script');
			</script>
			</body>
</html>
